<view class="page">
  <view wx:if="{{loading}}" class="state card">
    <text class="state-text">正在加载选手资料...</text>
  </view>

  <view wx:elif="{{error}}" class="state card">
    <text class="error-text">{{error}}</text>
    <button class="primary-button" bindtap="onRetryTap">重试</button>
  </view>

  <view wx:elif="{{fighter}}" class="detail">
    <view class="hero card {{isChinaFighter ? 'hero--china' : ''}}">
      <view wx:if="{{isChinaFighter}}" class="hero-flag-overlay">
        <view class="hero-flag-wave hero-flag-wave--top"></view>
        <view class="hero-flag-wave hero-flag-wave--bottom"></view>
        <text class="hero-star hero-star--main">★</text>
        <text class="hero-star hero-star--s1">★</text>
        <text class="hero-star hero-star--s2">★</text>
        <text class="hero-star hero-star--s3">★</text>
        <text class="hero-star hero-star--s4">★</text>
      </view>
      <image wx:if="{{fighter.avatar_url}}" class="avatar" src="{{fighter.avatar_url}}" mode="aspectFill" />
      <view class="hero-main">
        <view class="name">{{fighter.name}}</view>
        <view wx:if="{{fighter.name_zh}}" class="name-zh">{{fighter.name_zh}}</view>
        <view wx:if="{{fighter.nickname}}" class="nickname">昵称：{{fighter.nickname}}</view>
        <view class="chip-row">
          <text class="chip">国籍 {{countryDisplay || '-'}}</text>
          <text class="chip">战绩 {{fighter.record || '-'}}</text>
          <text class="chip">量级 {{weightClassDisplay || '待补充'}}</text>
          <text wx:if="{{pfpTag}}" class="chip chip--highlight">{{pfpTag}}</text>
          <text wx:if="{{statusTag}}" class="chip">{{statusTag}}</text>
          <text wx:if="{{titleTag}}" class="chip chip--title">{{titleTag}}</text>
        </view>
      </view>
    </view>

    <view class="section-card card">
      <view class="section">技术与资料</view>
      <view wx:if="{{statItems.length}}">
        <view class="kv-row" wx:for="{{statItems}}" wx:key="index">
          <text class="kv-label">{{item.label}}</text>
          <text class="kv-value">{{item.value}}</text>
        </view>
      </view>
      <view wx:else class="state-text">暂无技术统计</view>
    </view>

    <view class="section-card card">
      <view class="section">战绩拆解</view>
      <view wx:if="{{recordItems.length}}">
        <view class="kv-row" wx:for="{{recordItems}}" wx:key="index">
          <text class="kv-label">{{item.label}}</text>
          <text class="kv-value">{{item.value}}</text>
        </view>
      </view>
      <view wx:else class="state-text">暂无战绩数据</view>
    </view>

    <view wx:if="{{fighter.intro_video_url}}" class="section-card card">
      <view class="section">选手视频</view>
      <video class="intro-video" src="{{fighter.intro_video_url}}" controls />
    </view>

    <view class="section-card card">
      <view class="section">过往战绩</view>
      <view wx:if="{{historyItems && historyItems.length}}">
        <view class="update" wx:for="{{historyItems}}" wx:key="raw">
          <text class="result-tag {{item.resultClass}}">{{item.result || '—'}}</text>
          <text class="update-text">{{item.display}}</text>
        </view>
      </view>
      <view wx:else class="state-text">暂无过往战绩</view>
    </view>
  </view>
</view>
